(this.webpackJsonppetermusically=this.webpackJsonppetermusically||[]).push([[0],{168:function(e,t,a){e.exports=a(236)},173:function(e,t,a){},174:function(e,t,a){},236:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(15),l=a.n(c),i=(a(173),a(32)),o=(a(174),a(39)),u=a(16),s=a(272),m=a(41),d=a(42),p=a(46),f=a(44),b=function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null)}}]),a}(n.Component),g=a(273),E=a(155),h=a(292),v=a(274),j=a(275),y=a(57),O=a.n(y),w=a(141),k=a.n(w),x=a(287),S=a(271),C=a(28),$=a(289),N=a(23),W=a(96),T=a.n(W),q=a(290),F=T()((function(e){return{snackbar:{margin:e.spacing(1)}}}))((function(e){var t=e.classes,a=e.error,c=Object(n.useState)(!0),l=Object(N.a)(c,2),i=l[0],o=l[1];return r.a.createElement(q.a,{open:i,className:t.snackbar,message:a.message,action:r.a.createElement(x.a,{onClick:function(){return o(!1)},color:"secondary",size:"small"},"Close")})})),I=function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return this.props.navbar,r.a.createElement("div",null,"Loading...")}}]),a}(n.Component);function L(){var e=Object(i.a)(["\nmutation delete_track ($url: String!) {\n  deleteTrack(url:$url) {\n    url\n  }\n}"]);return L=function(){return e},e}var z=Object(C.b)(L()),D=function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(m.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).handle_delete=function(e){e()},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement($.a,{mutation:z,variables:{url:this.props.track.url}},(function(t,a){var n=a.loading,c=a.error;a.data;return c?r.a.createElement(F,{error:c}):n?r.a.createElement(I,null):r.a.createElement(x.a,null,r.a.createElement(S.a,{onClick:function(){e.handle_delete(t)}}))}))}}]),a}(n.Component),A=function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props.track;return r.a.createElement(s.a,{item:!0,xs:10,style:{margin:"auto"}},r.a.createElement(g.a,null,r.a.createElement(s.a,{container:!0,justify:"space-evenly",style:{alignItems:"center"}},r.a.createElement(s.a,{item:!0,xs:1},r.a.createElement(v.a,null)),r.a.createElement(s.a,{item:!0,xs:2},r.a.createElement(s.a,{container:!0},r.a.createElement(s.a,{item:!0,xs:12},r.a.createElement(E.a,{variant:"body1"},e.name)),r.a.createElement(s.a,{item:!0,xs:12},r.a.createElement(E.a,{variant:"caption"},e.user)))),r.a.createElement(s.a,{item:!0},r.a.createElement(h.a,{my:"10px"},r.a.createElement(k.a,{url:O.a.defaults.baseURL+"/music/"+e.url,height:"30px",width:"500px",controls:!0}))),r.a.createElement(D,{track:e}),r.a.createElement(j.a,null))))}}]),a}(n.Component),_=a(40),R=a.n(_),U=a(63),M=a(291),J=a(281),P=a(277),B=a(278),G=a(276),Q=a(293),H=a(280),K=a(286),V=a(282),X=a(151),Y=a.n(X),Z=a(150),ee=a.n(Z),te=a(152),ae=a.n(te);function ne(){var e=Object(i.a)(["\n  mutation ($title: String!, $description: String!, $hashtag: String!, $url: String!) {\n    createTrack(title: $title, description: $description, hashtag: $hashtag, url: $url) \n    {\n      track {\n        id\n        title\n        description\n        hashtag\n        url\n        owner {\n          id\n          username\n        }\n      }\n    }\n  }\n"]);return ne=function(){return e},e}var re=Object(C.b)(ne()),ce=T()((function(e){return{container:{display:"flex",flexWrap:"wrap"},dialog:{margin:"0 auto",maxWidth:550},textField:{margin:e.spacing(1)},cancel:{color:"red"},save:{color:"green"},button:{margin:e.spacing(2)},icon:{marginLeft:e.spacing(1)},input:{display:"none"},fab:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2),zIndex:"200"}}}))((function(e){var t=e.classes,a=Object(n.useState)(!1),c=Object(N.a)(a,2),l=c[0],i=c[1],o=Object(n.useState)(""),u=Object(N.a)(o,2),s=u[0],m=u[1],d=Object(n.useState)(""),p=Object(N.a)(d,2),f=p[0],b=p[1],g=Object(n.useState)(""),E=Object(N.a)(g,2),h=E[0],v=E[1],j=Object(n.useState)(""),y=Object(N.a)(j,2),w=y[0],k=y[1],S=Object(n.useState)(!1),C=Object(N.a)(S,2),W=C[0],T=C[1],q=Object(n.useState)(""),I=Object(N.a)(q,2),L=I[0],z=I[1],D=function(e){var t=e.target.files[0];t&&t.size>15e6?z("".concat(t.name,": the file is limited 15Mb")):(k(t),z(""))},A=function(){var e=Object(U.a)(R.a.mark((function e(){var t,a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(t=new FormData).append("file",w),e.next=5,O.a.post(O.a.defaults.baseURL+"/music/",t);case 5:return a=e.sent,e.abrupt("return",a.data.url);case 9:e.prev=9,e.t0=e.catch(0),console.error("Cannot upload file",e.t0),T(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(U.a)(R.a.mark((function e(t,a){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),T(!0),e.next=4,A();case 4:n=e.sent,a({variables:{title:s,hashtag:f,description:h,url:n}});case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{onClick:function(){return i(!0)},variant:"contained",className:t.fab,color:"secondary"},l?r.a.createElement(ee.a,null):r.a.createElement(Y.a,null)),r.a.createElement($.a,{mutation:re,onCompleted:function(e){T(!1),i(!1),m(""),v(""),b(""),k("")},update:function(e,t){var a=t.data.createTrack,n=e.readQuery({query:We}).music.concat(a.music);e.writeQuery({query:We,data:{music:n}})}},(function(e,a){a.loading;var n=a.error;return n?r.a.createElement(F,{error:n}):r.a.createElement(M.a,{open:l,className:t.dialog},r.a.createElement("form",{name:"form",onSubmit:function(t){return _(t,e)}},r.a.createElement(G.a,null,"Create Track"),r.a.createElement(P.a,null,r.a.createElement(B.a,null,"Title"),r.a.createElement(Q.a,{fullWidth:!0},r.a.createElement(K.a,{label:"Title",placeholder:"Title",onChange:function(e){return m(e.target.value)},value:s,className:t.textField})),r.a.createElement(Q.a,{fullWidth:!0},r.a.createElement(K.a,{multiline:!0,rows:"3",label:"Description",placeholder:"Description",onChange:function(e){return v(e.target.value)},value:h,className:t.textField})),r.a.createElement(Q.a,{fullWidth:!0},r.a.createElement(K.a,{multiline:!0,rows:"3",label:"Hashtag",placeholder:"#",onChange:function(e){return b(e.target.value)},value:f,className:t.textField})),r.a.createElement(Q.a,{error:Boolean(L)},r.a.createElement("input",{id:"audio",required:!0,type:"file",accept:"audio",className:t.input,onChange:D}),r.a.createElement("label",{htmlFor:"audio"},r.a.createElement(x.a,{variant:"outlined",color:w?"secondary":"inherit",component:"span",className:t.button},"Max size 15Mb",r.a.createElement(ae.a,{className:t.icon})),w&&w.name,r.a.createElement(H.a,null,L)))),r.a.createElement(J.a,null,r.a.createElement(x.a,{disabled:W,onClick:function(){return i(!1)},className:t.cancel},"Cancel"),r.a.createElement(x.a,{disabled:W||!s.trim()||!h.trim()||!w,type:"cancel",className:t.save},W?r.a.createElement(V.a,{className:t.save,size:24}):"Submit"))))})))})),le=function(e){e.classes,e.props;return r.a.createElement("div",{style:{marginTop:"3rem"}},r.a.createElement(b,null),r.a.createElement($.b,{query:We},(function(e){var t=e.data,a=e.loading,n=e.error;if(a)return r.a.createElement("div",null,"loading...");if(n)return r.a.createElement(F,{error:n});var c=t.music;return r.a.createElement(s.a,{container:!0},a&&r.a.createElement("div",null," Loading... "),c.map((function(e){return r.a.createElement(A,{key:e.id,track:e})})))})),r.a.createElement(ce,null))},ie=a(17),oe=a(284),ue=a(285),se=a(9),me=a(283),de=function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){var e;e=r.a.createElement($.b,{query:$e,fetchPolicy:"cache-and-network"},(function(e){e.error,e.loading;var a=e.data;return a?r.a.createElement(o.b,{to:"/profile/".concat(a.userself.id),className:t.grow,style:{justifyContent:"flex-end"}},r.a.createElement(me.a,null),r.a.createElement(E.a,{variant:"h5",noWrap:!0,className:t.username},a.userself.username)):r.a.createElement(s.a,{container:!0,style:{width:"auto",display:"flex",flexDirection:"row-reverse",flexGrow:1}},r.a.createElement(s.a,{item:!0,col:!0},r.a.createElement(o.b,{to:"/login"},r.a.createElement(x.a,null,"Login")),r.a.createElement(o.b,{to:"/signup"},r.a.createElement(x.a,null,"Signup"))))}));var t=this.props.classes;return r.a.createElement(oe.a,{className:t.root},r.a.createElement(ue.a,null,r.a.createElement(o.b,{to:"/",className:t.grow},r.a.createElement(E.a,{variant:"h5",color:"secondary",noWrap:!0},"Peter Muscially"),e)))}}]),a}(n.Component),pe=Object(se.a)((function(e){return{root:{position:"static",flexGrow:1,margin:0,padding:0},grow:{flexGrow:1,display:"flex",alignItems:"center",textDecoration:"none"},logo:{marginRight:e.spacing(1),fontSize:45},faceIcon:{marginRight:e.spacing(1),fontSize:30,color:"white"},username:{color:"white",fontSize:30}}}))(de),fe=a(294),be=a(279);function ge(){var e=Object(i.a)(["\nmutation ($username: String!, $password: String!){\n    tokenAuth(username: $username, password: $password){\n        token\n    }\n}"]);return ge=function(){return e},e}var Ee=Object(C.b)(ge()),he=Object(se.a)((function(e){return{form:{width:"100%",marginTop:e.spacing(1)},account_trans:{textAlign:"center",marginTop:"2rem",color:"black","&:hover":{cursor:"pointer"}}}}))((function(e){var t=e.classes,a=Object(n.useState)(""),c=Object(N.a)(a,2),l=c[0],i=c[1],u=Object(n.useState)(""),m=Object(N.a)(u,2),d=m[0],p=m[1],f=function(){var e=Object(U.a)(R.a.mark((function e(t,a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,a();case 4:r=e.sent,localStorage.setItem("authToken",r.data.tokenAuth.token),n.writeDate({data:{isLoggedIn:!0}}),e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return");case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,a,n){return e.apply(this,arguments)}}();return r.a.createElement(s.a,{container:!0,direction:"row",style:{justifyContent:"center"}},r.a.createElement(s.a,{item:!0,xs:8,spacing:2},r.a.createElement($.a,{mutation:Ee,variables:{username:l,password:d},onError:function(){console.log("error")}},(function(e,a){var n=a.loading,c=a.error,o=(a.called,a.client);return r.a.createElement("form",{onSubmit:function(t){return f(t,e,o)},className:t.form},r.a.createElement(Q.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(fe.a,{htmlFor:"username"},"username"),r.a.createElement(be.a,{id:"username",onChange:function(e){return i(e.target.value)}})),r.a.createElement(Q.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(fe.a,{htmlFor:"password"},"Password"),r.a.createElement(be.a,{id:"password",type:"password",onChange:function(e){return p(e.target.value)}})),r.a.createElement(x.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:n||!l.trim()||!d.trim(),className:t.submit},n?"loading":"Login"),c&&r.a.createElement(F,{error:c}))}))),r.a.createElement(s.a,{item:!0,xs:8},r.a.createElement(o.b,{to:"/signup"},r.a.createElement(E.a,{className:t.account_trans,variant:"body2",fullWidth:!0},"Don't a account? ",r.a.createElement("a",null," Signup ")))))}));function ve(){var e=Object(i.a)(["\nmutation ($username:String!, $password:String!, $email:String!) {\n    createUser(username:$username, password:$password, email:$email) {\n        user {\n            username\n            email\n        }\n    }\n}"]);return ve=function(){return e},e}var je=Object(C.b)(ve()),ye=Object(se.a)((function(e){return{form:{width:"100%",marginTop:e.spacing(1)},account_trans:{textAlign:"center",marginTop:"2rem",color:"black","&:hover":{cursor:"pointer"}}}}))((function(e){var t=e.classes,a=Object(n.useState)(""),c=Object(N.a)(a,2),l=c[0],i=c[1],u=Object(n.useState)(""),m=Object(N.a)(u,2),d=m[0],p=m[1],f=Object(n.useState)(""),b=Object(N.a)(f,2),g=b[0],h=b[1],v=function(){var e=Object(U.a)(R.a.mark((function e(t,a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,a();case 4:r=e.sent,localStorage.setItem("authToken",r.data.tokenAuth.token),n.writeDate({data:{isLoggedIn:!0}}),e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return");case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,a,n){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{container:!0,direction:"row",style:{justifyContent:"center"}},r.a.createElement(s.a,{item:!0,xs:8,spacing:2},r.a.createElement($.a,{mutation:je,variables:{username:l,email:d,password:g},onError:function(){}},(function(e,a){var n=a.loading,c=a.error,o=(a.called,a.client);return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:function(t){return v(t,e,o)},className:t.form},r.a.createElement(Q.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(fe.a,{htmlFor:"username"},"Username"),r.a.createElement(be.a,{id:"username",onChange:function(e){return i(e.target.value)}})),r.a.createElement(Q.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(fe.a,{htmlFor:"email"},"email"),r.a.createElement(be.a,{id:"email",onChange:function(e){return p(e.target.value)}})),r.a.createElement(Q.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(fe.a,{htmlFor:"password"},"Password"),r.a.createElement(be.a,{id:"password",type:"password",onChange:function(e){return h(e.target.value)}})),r.a.createElement(x.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:n||!l.trim()||!g.trim(),className:t.submit},n?"loading":"Signup"),c&&r.a.createElement(F,{error:c})))})))),r.a.createElement(o.b,{to:"/login"},r.a.createElement(E.a,{className:t.account_trans,variant:"body2",fullWidth:!0},"Already have a account? ",r.a.createElement("a",null," Login "))))})),Oe=function(e,t){var a=e.match.params.id;return r.a.createElement($.b,{query:Ne,variables:{id:a}},(function(e){var t=e.loading,a=e.error,n=e.data;return t?r.a.createElement(I,null):a?r.a.createElement(F,{error:a}):(console.log(n),r.a.createElement(s.a,{container:!0,style:{display:"flex"}},r.a.createElement(me.a,{color:"primary"}),r.a.createElement(s.a,{item:!0},r.a.createElement(E.a,{variant:"body1"},n.user.username),r.a.createElement(E.a,{variant:"caption"},n.user.email)),n.user.musicSet.map((function(e){return r.a.createElement(A,{track:e})}))))}))};function we(){var e=Object(i.a)(["\n  query getTracksQuery {\n    music {\n      id\n      title\n      description\n      hashtag\n      url\n      owner {\n        id\n        username\n      }\n    }\n  }\n\n"]);return we=function(){return e},e}function ke(){var e=Object(i.a)(["\n  query ($id:Int!){\n    user (id: $id){\n      id\n      username\n      email\n      dateJoined\n      musicSet{\n        id\n        title\n        url\n      }\n    }\n  }\n"]);return ke=function(){return e},e}function xe(){var e=Object(i.a)(["\n  {\n    userself {\n      id\n      username\n      email\n    }\n  }\n"]);return xe=function(){return e},e}function Se(){var e=Object(i.a)(["\n    query {\n        isLoggedIn @client\n    }\n"]);return Se=function(){return e},e}O.a.defaults.baseURL="https://musically.tbitzz.com";var Ce=new C.a({uri:O.a.defaults.baseURL+"/graphql/",fetchOptions:{credentials:"include"},request:function(e){var t=localStorage.getItem("authToken")||"";e.setContext({headers:{Authorization:"JWT ".concat(t)}})},clientState:{defaults:{isLoggedIn:!!localStorage.getItem("authToken")}}}),$e=(Object(C.b)(Se()),Object(C.b)(xe())),Ne=Object(C.b)(ke());var We=Object(C.b)(we()),Te=function(){return r.a.createElement(ie.a,{client:Ce},r.a.createElement(o.a,null,r.a.createElement(pe,null),r.a.createElement(u.c,null,r.a.createElement(u.a,{exact:!0,path:"/",component:le}),r.a.createElement(u.a,{exact:!0,path:"/login",component:he}),r.a.createElement(u.a,{exact:!0,path:"/signup",component:ye}),r.a.createElement(u.a,{path:"/profile/:id",component:Oe}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[168,1,2]]]);
//# sourceMappingURL=main.849e2a90.chunk.js.map